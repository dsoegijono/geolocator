/*
  Geolocator Javascript Lib v.1.2.9
  (c) 2014-2015 Onur Yildirim (onur@cutepilot.com)
  https://github.com/onury/geolocator
  MIT License
*/
(function(){function o(){"use strict";function o(o,e,t){function n(o,e){t&&a.parentNode&&a.parentNode.removeChild(a),"function"==typeof o&&o(e)}var a=document.createElement("script");a.async=!0,a.readyState?a.onreadystatechange=function(o){("loaded"===a.readyState||"complete"===a.readyState)&&(a.onreadystatechange=null,n(e))}:a.onload=function(o){n(e)},a.onerror=function(e){var t="Could not load source at "+(o+"").replace(/\?.*$/,"");n(g,Error(t))},a.src=o,document.getElementsByTagName("head")[0].appendChild(a)}function e(e){function t(){d.__glcb&&delete d.__glcb,google.load("maps",f,{other_params:"",callback:e})}void 0!==window.google&&void 0!==google.maps?e&&e():void 0!==window.google&&void 0!==google.loader?t():(d.__glcb=t,o(y+"?callback=geolocator.__glcb"))}function t(o,e,t){var n,a,c,l=document.getElementById(o);l?(n=new google.maps.Map(l,e),a=new google.maps.Marker({position:e.center,map:n}),c=new google.maps.InfoWindow,c.setContent(t),google.maps.event.addListener(a,"click",function(){c.open(n,a)}),d.location.map={canvas:l,map:n,options:e,marker:a,infoWindow:c}):d.location.map=null}function n(o,e){function t(o,t){t===google.maps.GeocoderStatus.OK&&e&&e(o)}var n=new google.maps.Geocoder;n.geocode({latLng:o},t)}function a(o){if(o&&o.length>0){var e,t,n={},a=o[0].address_components;for(e=0;e<a.length;e+=1)t=a[e],t.types&&t.types.length>0&&(n[t.types[0]]=t.long_name,n[t.types[0]+"_s"]=t.short_name);d.location.formattedAddress=o[0].formatted_address,d.location.address={street:n.route||"",neighborhood:n.neighborhood||"",town:n.sublocality||"",city:n.locality||"",region:n.administrative_area_level_1||"",country:n.country||"",countryCode:n.country_s||"",postalCode:n.postal_code||"",streetNumber:n.street_number||""}}}function c(o){function e(o){a(o);var e=null===d.location.ipGeoSource?14:7,n={zoom:e,center:c,mapTypeId:"roadmap"};t(p,n,o[0].formatted_address),s&&s.call(null,d.location)}var c=new google.maps.LatLng(o.latitude,o.longitude);n(c,e)}function l(o,e){function t(e){var t=o===!0?0:"number"==typeof o?o:-1;t>=0?d.locateByIP(s,g,t,p):g&&g(e)}function n(o){d.location={ipGeoSource:null,coords:o.coords,timestamp:(new Date).getTime()},c(d.location.coords)}function a(o){t(o)}d.location=null,navigator.geolocation?navigator.geolocation.getCurrentPosition(n,a,e):t(Error("geolocation is not supported."))}function i(o,e){switch(o){case 0:d.location={coords:{latitude:e.latitude,longitude:e.longitude},address:{city:e.city,country:e.country_name,countryCode:e.country_code,region:e.region_name}};break;case 1:d.location={coords:{latitude:e.geoplugin_latitude,longitude:e.geoplugin_longitude},address:{city:e.geoplugin_city,country:e.geoplugin_countryName,countryCode:e.geoplugin_countryCode,region:e.geoplugin_regionName}};break;case 2:d.location={coords:{latitude:e.lat,longitude:e.lon},address:{city:e.city,country:"",countryCode:e.country,region:""}}}d.location&&(d.location.coords.accuracy=null,d.location.coords.altitude=null,d.location.coords.altitudeAccuracy=null,d.location.coords.heading=null,d.location.coords.speed=null,d.location.timestamp=(new Date).getTime(),d.location.ipGeoSource=b[o],d.location.ipGeoSource.data=e)}function r(o){function t(){2===m?void 0!==window.Geo&&(i(m,window.Geo),delete window.Geo,n=!0):void 0!==o&&"string"!=typeof o&&(i(m,o),n=!0),n===!0?c(d.location.coords):g&&g(Error(o||"Could not get location."))}var n=!1;d.location=null,delete d.__ipscb,e(t)}function u(e){void 0===e.cbParam||null===e.cbParam||""===e.cbParam?o(e.url,r,!0):o(e.url+"?"+e.cbParam+"=geolocator.__ipscb",void 0,!0)}var s,g,p,m,y="https://www.google.com/jsapi",f="3.18",b=[{url:"//freegeoip.net/json/",cbParam:"callback"},{url:"//www.geoplugin.net/json.gp",cbParam:"jsoncallback"},{url:"//geoiplookup.wikimedia.org/",cbParam:""}],_=1;return{location:null,locate:function(o,t,n,a,c){function i(){l(n,a)}s=o,g=t,p=c,e(i)},locateByIP:function(o,e,t,n){m="number"!=typeof t||0>t||t>=b.length?_:t,s=o,g=e,p=n,d.__ipscb=r,u(b[m])},isPositionError:function(o){return"[object PositionError]"===Object.prototype.toString.call(o)}}}var e=objectTypes[typeof exports]&&exports&&!exports.nodeType?exports:void 0,t=objectTypes[typeof module]&&module&&!module.nodeType?module:void 0,n=t&&t.exports===e?e:void 0,a=checkGlobal(e&&t&&"object"==typeof global&&global),c=checkGlobal(objectTypes[typeof self]&&self),l=checkGlobal(objectTypes[typeof window]&&window),i=checkGlobal(objectTypes[typeof this]&&this),r=a||l!==(i&&i.window)&&l||c||i||Function("return this")(),d=o();(l||c||{}).geolocator=d,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return d}):e&&t?(n&&((t.exports=d).geolocator=d),e.geolocator=d):r.geolocator=d}).call(this);
